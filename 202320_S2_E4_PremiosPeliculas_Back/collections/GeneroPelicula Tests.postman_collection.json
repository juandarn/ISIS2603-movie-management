{
	"info": {
		"_postman_id": "72767cdf-3ac2-4a90-a064-df0d0f756f1a",
		"name": "GeneroPelicula Tests",
		"description": "Colección de pruebas sobre el recurso PlataformaGenero",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "29281547"
	},
	"item": [
		{
			"name": "Crear un genero",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var data = pm.response.json()\r",
							"pm.globals.set(\"genero_id_1\", data.id);\r",
							"\r",
							"pm.test(\"Status code is 201\", function () {\r",
							"   pm.response.to.have.status(201);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n    \"nombre\": \"drama\"\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/generos",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"generos"
					]
				},
				"description": "Crea un nuevo genero. El recurso solo tiene de atributo \"name\" que debe ser único. El Id es inicializado por la BD y se debe ver en la respuesta.\n\nPara la prueba, se guarda el id en una variable que será utilizada en otras peticiones de la colección.\n\n**Código http esperado: 200**"
			},
			"response": []
		},
		{
			"name": "Crear una pelicula",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var data = pm.response.json()\r",
							"pm.globals.set(\"pelicula_id_1\", data.id);\r",
							"\r",
							"pm.test(\"Status code is 201\", function () {\r",
							"   pm.response.to.have.status(201);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n    \"nombre\": \"pedro y sus aventuras\",\r\n    \"duracion\": 70,\r\n    \"pais\": \"Colombia\",\r\n    \"idiomaOriginal\": \"Español\",\r\n    \"fechaEstreno\": \"1927-03-03T00:00:00-05:00\",\r\n    \"linkTrailer\": \"http:pedro_aventuras.com\"\r\n} ",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/peliculas",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"peliculas"
					]
				},
				"description": "Crea una nueva pelicula. El recurso tiene los atributos de las peliculas como nombe, duracion, pais, idiomaOriginal, fechaEstreno y linkTrailer. El Id es inicializado por la BD y se debe ver en la respuesta.\n\nPara la prueba, se guarda el id en una variable que será utilizada en otras peticiones de la colección.\n\n**Código http esperado: 200**"
			},
			"response": []
		},
		{
			"name": "Agregar un a pelicula que no existe a un genero",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 404\", function () {\r",
							"   pm.response.to.have.status(404);\r",
							"});\r",
							"\r",
							"pm.test(\"Get expected error message\", function () {\r",
							"   var data = pm.response.json();\r",
							"   pm.expect(data.apierror.message).to.eql(\"Película no encontrada\");\r",
							"});\r",
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/generos/{{genero_id_1}}/peliculas/0",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"generos",
						"{{genero_id_1}}",
						"peliculas",
						"0"
					]
				},
				"description": "Asocia una película que no existe a un género en la aplicación.\n\nSe envía el Id del género y el de la pelicula a asociar en la URL de la petición.\n\nPara la prueba se verifica que se genera el error.\n\n**Código http esperado: 404**"
			},
			"response": []
		},
		{
			"name": "Agregar una pelicula a un genero",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {\r",
							"   pm.response.to.have.status(200);\r",
							"});"
						],
						"type": "text/javascript"
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/generos/{{genero_id_1}}/peliculas/{{pelicula_id_1}}",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"generos",
						"{{genero_id_1}}",
						"peliculas",
						"{{pelicula_id_1}}"
					]
				},
				"description": "Asocia una pelicula a un género en la aplicación.\n\nSe envía el Id del género y el de la pelicula a asociar en la URL de la petición.\n\n**Código http esperado: 200**"
			},
			"response": []
		},
		{
			"name": "Obtener una pelicula de un genero",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {\r",
							"   pm.response.to.have.status(200);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/peliculas/{{pelicula_id_1}}/generos/{{genero_id_1}}",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"peliculas",
						"{{pelicula_id_1}}",
						"generos",
						"{{genero_id_1}}"
					]
				},
				"description": "Consulta una pelicula de un genero en la aplicación.  \nLa petición no tiene cuerpo.\n\nSe envía el Id del género y de la película a consultar en la URL de la petición.\n\n**Código http esperado: 200**"
			},
			"response": []
		},
		{
			"name": "Obtener una pelicula que no existe",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 404\", function () {\r",
							"   pm.response.to.have.status(404);\r",
							"});\r",
							"\r",
							"pm.test(\"Get expected error message\", function () {\r",
							"   var data = pm.response.json();\r",
							"   pm.expect(data.apierror.message).to.eql(\"Genero no encontrado\");\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/peliculas/{{pelicula_id_1}}/generos/0",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"peliculas",
						"{{pelicula_id_1}}",
						"generos",
						"0"
					]
				},
				"description": "Consulta una película que no existe de un género en la aplicación.\n\nPara la prueba se verifica que se genera el error.\n\n**Código http esperado: 404**"
			},
			"response": []
		},
		{
			"name": "Asociar peliculas a un genero",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {\r",
							"   pm.response.to.have.status(200);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "[{\r\n    \"nombre\": \"pedro y sus aventuras\",\r\n    \"duracion\": 70,\r\n    \"pais\": \"Colombia\",\r\n    \"idiomaOriginal\": \"Español\",\r\n    \"fechaEstreno\": \"1927-03-03T00:00:00-05:00\",\r\n    \"linkTrailer\": \"http:pedro_aventuras.com\",\r\n    \"id\":{{pelicula_id_1}}\r\n} ,\r\n{\"nombre\": \"peter pan\",\r\n    \"duracion\": 70,\r\n    \"pais\": \"EEUU\",\r\n    \"idiomaOriginal\": \"Ingles\",\r\n    \"fechaEstreno\": \"1989-03-03T00:00:00-05:00\",\r\n    \"linkTrailer\": \"http:peterpan.com\",\r\n    \"id\":{{pelicula_id_1}}\r\n}]",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/generos/{{genero_id_1}}/peliculas",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"generos",
						"{{genero_id_1}}",
						"peliculas"
					]
				},
				"description": "Actualiza la lista de peliculas de un género existente.\n\nSe envía el Id en la URL de la petición.\n\n**Código http esperado: 200**"
			},
			"response": []
		},
		{
			"name": "Asociar peliculas a un genero que no existe",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 404\", function () {",
							"   pm.response.to.have.status(404);",
							"});",
							"",
							"pm.test(\"Get expected error message\", function () {",
							"   var data = pm.response.json();",
							"   pm.expect(data.apierror.message).to.eql(\"Género no encontrado\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "[{\n    \"nombre\": \"pedro y sus aventuras\",\n    \"duracion\": 70,\n    \"pais\": \"Colombia\",\n    \"idiomaOriginal\": \"Español\",\n    \"fechaEstreno\": \"1927-03-03T00:00:00-05:00\",\n    \"linkTrailer\": \"http:pedro_aventuras.com\",\n    \"id\":{{pelicula_id_1}}\n} ,\n{\"nombre\": \"peter pan\",\n    \"duracion\": 70,\n    \"pais\": \"EEUU\",\n    \"idiomaOriginal\": \"Ingles\",\n    \"fechaEstreno\": \"1989-03-03T00:00:00-05:00\",\n    \"linkTrailer\": \"http:peterpan.com\",\n        \"id\":{{pelicula_id_1}}\n\n}]",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{baseUrl}}/generos/0/peliculas",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"generos",
						"0",
						"peliculas"
					]
				},
				"description": "Actualiza la lista de película de un género existente con películas que no existen.\n\nSe envía el Id en la URL de la petición.\n\nPara la prueba se verifica que se genera el error.\n\n**Código http esperado: 404**"
			},
			"response": []
		},
		{
			"name": "Obtener las peliculas de un género",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Number of peliculas > ' + 0, function () {",
							"   var data = pm.response.json()",
							"   pm.expect(data.length).to.greaterThan(0)",
							"});",
							"",
							"pm.test(\"Status code is 200\", function () {",
							"   pm.response.to.have.status(200);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/generos/{{genero_id_1}}/peliculas",
					"host": [
						"{{baseUrl}}"
					],
					"path": [
						"generos",
						"{{genero_id_1}}",
						"peliculas"
					]
				},
				"description": "Consulta las películas de un género en la aplicación.  \nLa petición no tiene cuerpo.\n\nSe envía el Id del género y el de la película a consultar en la URL de la petición.\n\n**Código http esperado: 200**"
			},
			"response": []
		}
	]
}